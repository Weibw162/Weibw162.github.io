(window.webpackJsonp=window.webpackJsonp||[]).push([[239],{573:function(a,t,s){"use strict";s.r(t);var n=s(7),e=Object(n.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h2",{attrs:{id:"问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#问题"}},[a._v("#")]),a._v(" 问题")]),a._v(" "),t("p",[a._v("你的包中包含代码需要去读取的数据文件。你需要尽可能地用最便捷的方式来做这件事。")]),a._v(" "),t("h2",{attrs:{id:"解决方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#解决方案"}},[a._v("#")]),a._v(" 解决方案")]),a._v(" "),t("p",[a._v("假设你的包中的文件组织成如下：")]),a._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[a._v("mypackage"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("\n    __init__"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("py\n    somedata"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("dat\n    spam"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("py\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br")])]),t("p",[a._v("现在假设spam.py文件需要读取somedata.dat文件中的内容。你可以用以下代码来完成：")]),a._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# spam.py")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" pkgutil\ndata "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" pkgutil"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("get_data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("__package__"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'somedata.dat'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br")])]),t("p",[a._v("由此产生的变量是包含该文件的原始内容的字节字符串。")]),a._v(" "),t("h2",{attrs:{id:"讨论"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#讨论"}},[a._v("#")]),a._v(" 讨论")]),a._v(" "),t("p",[a._v("要读取数据文件，你可能会倾向于编写使用内置的I/ O功能的代码，如open()。但是这种方法也有一些问题。")]),a._v(" "),t("p",[a._v("首先，一个包对解释器的当前工作目录几乎没有控制权。因此，编程时任何I/O操作都必须使用绝对文件名。由于每个模块包含有完整路径的__file__变量，这弄清楚它的路径不是不可能，但它很凌乱。")]),a._v(" "),t("p",[a._v("第二，包通常安装作为.zip或.egg文件，这些文件并不像在文件系统上的一个普通目录里那样被保存。因此，你试图用open()对一个包含数据文件的归档文件进行操作，它根本不会工作。")]),a._v(" "),t("p",[a._v("pkgutil.get_data()函数是一个读取数据文件的高级工具，不用管包是如何安装以及安装在哪。它只是工作并将文件内容以字节字符串返回给你")]),a._v(" "),t("p",[a._v("get_data()的第一个参数是包含包名的字符串。你可以直接使用包名，也可以使用特殊的变量，比如__package__。第二个参数是包内文件的相对名称。如果有必要，可以使用标准的Unix命名规范到不同的目录，只要最后的目录仍然位于包中。")])])}),[],!1,null,null,null);t.default=e.exports}}]);